"use strict";

var username = 'stasokulov';
var linkToMyGit = "https://api.github.com/users/".concat(username);
var numRepos = '';
var reposPerPage = 10;
var pageForLoad = 1;
getRepos(pageForLoad);
goPagination();
function getRepos(pageForLoad) {
  var preloader = document.querySelector('.preloader__wrap_git');
  preloader.classList.remove('hidden');
  var linkToMyRepos = "".concat(linkToMyGit, "/repos?per_page=").concat(reposPerPage, "&page=").concat(pageForLoad);
  fetch(linkToMyRepos).then(function (response) {
    if (response.status === 200) {
      return response.json();
    } else {
      alert('Запрос на github.com не удался. Ошибка: ' + response.status);
    }
  }).then(function (arr) {
    arr.forEach(function (element) {
      gitItemCreator(element);
    });
  }).then(function () {
    preloader.classList.add('hidden');
  });
}
;
fetch(linkToMyGit).then(function (response) {
  if (response.status === 200) {
    return response.json();
  } else {
    alert('Запрос на github.com не удался. Ошибка: ' + response.status);
  }
}).then(function (json) {
  numRepos = json.public_repos;
  return numRepos;
}).then(function (numRepos) {
  var numPages = Math.ceil(numRepos / reposPerPage);
  for (var i = 1; i <= numPages; i++) {
    createPagination(i);
  }
  ;
});
function gitItemCreator(element) {
  var container = document.querySelector('.git__list');
  var item = createElement('li');
  item.classList.add('git__main__item');
  var link = createElement('a');
  link.classList.add('git__item-innerWrap');
  link.classList.add('link');
  link.href = element.html_url;
  link.target = 'blank';
  var title = createElement('p');
  title.classList.add('git__item-title');
  title.innerHTML = element.name;
  var string = createElement('p');
  string.classList.add('git__item-text');
  var marker = createElement('span');
  marker.classList.add('marker');
  switch (element.language) {
    case 'HTML':
      marker.classList.add('marker_HTML');
      break;
    case 'CSS':
      marker.classList.add('marker_CSS');
      break;
    case 'JS':
      marker.classList.add('marker_JS');
      break;
  }
  ;
  var progLang = createElement('span');
  progLang.classList.add('text-element');
  progLang.classList.add('text-element_progLang');
  progLang.innerHTML = element.language;
  var starWrap = createElement('span');
  starWrap.classList.add('text-element');
  var star = createElement('span');
  star.classList.add('text-element_star');
  var forkWrap = createElement('span');
  forkWrap.classList.add('text-element');
  var fork = createElement('span');
  fork.classList.add('text-element_fork');
  var dateUpdate = createElement('span');
  dateUpdate.classList.add('text-element');
  dateUpdate.classList.add('text-element_update');
  dateUpdate.innerHTML = 'Обновлено ' + new Date(element.updated_at).toLocaleDateString('ru') + 'г.';
  starWrap.appendChild(star);
  forkWrap.appendChild(fork);
  string.appendChild(marker);
  string.appendChild(progLang);
  string.appendChild(starWrap);
  string.appendChild(forkWrap);
  string.appendChild(dateUpdate);
  link.appendChild(title);
  link.appendChild(string);
  item.appendChild(link);
  if (element.stargazers_count) {
    starWrap.appendChild(document.createTextNode(element.stargazers_count));
  } else {
    starWrap.remove();
  }
  ;
  if (element.forks_count) {
    fork.appendChild(document.createTextNode(element.forks_count));
  } else {
    fork.remove();
  }
  ;
  container.appendChild(item);
}
;
function createPagination(pageCount) {
  var paginator = document.querySelector('.paginator');
  var paginationItem = document.querySelector('.paginator__item').cloneNode(true);
  paginationItem.classList.remove('hidden');
  if (pageCount === 1) {
    paginationItem.classList.add('paginator__item_active');
  }
  ;
  paginationItem.appendChild(document.createTextNode(pageCount));
  paginator.appendChild(paginationItem);
}
;
function goPagination() {
  var paginator = document.querySelector('.paginator');
  paginator.addEventListener('click', function (e) {
    if (e.target.className === 'paginator__item') {
      var allRepos = document.querySelectorAll('.git__main__item');
      allRepos = Array.from(allRepos);
      allRepos.forEach(function (element) {
        element.remove();
      });
      var page = e.target.innerText;
      getRepos(page);
      var paginationItems = document.querySelectorAll('.paginator__item');
      paginationItems = Array.from(paginationItems);
      paginationItems.forEach(function (element) {
        element.classList.remove('paginator__item_active');
      });
      e.target.classList.add('paginator__item_active');
    }
    ;
  });
}
;
function createElement(tag) {
  var element = document.createElement(tag);
  return element;
}
;
var burger = document.querySelector('.burger');
var burgerItem1 = document.querySelector('.burger__item-1');
var burgerItem2 = document.querySelector('.burger__item-2');
var mobileMenu = document.querySelector('.header__mobileMenu');
var main = document.querySelector('main');
var footer = document.querySelector('.footer__wrap');
burger.addEventListener('click', function () {
  burgerItem1.classList.toggle('burger__item-1_active');
  burgerItem2.classList.toggle('burger__item-2_active');
  mobileMenu.classList.toggle('hidden');
  main.classList.toggle('hidden');
  footer.classList.toggle('hidden');
});
var body = document.querySelector('body');
body.addEventListener('click', function (e) {
  if (e.target.classList.contains('scroll')) {
    var scroll = function scroll() {
      progress += lenghtStep;
      setTimeout(function () {
        window.scrollTo(0, progress);
        countStep++;
        if (countStep < numStep) {
          scroll();
        }
        ;
      }, 10);
    };
    burgerItem1.classList.remove('burger__item-1_active');
    burgerItem2.classList.remove('burger__item-2_active');
    mobileMenu.classList.add('hidden');
    main.classList.remove('hidden');
    footer.classList.remove('hidden');
    var targetClass = e.target.dataset.target;
    var aimBlock = document.querySelector('.' + targetClass);
    var finish = aimBlock.offsetTop;
    var start = window.pageYOffset;
    var numStep = 50;
    var lenghtStep = (finish - start) / numStep;
    var progress = start;
    var countStep = 0;
    scroll();
    ;
  }
  ;
});
window.onload = function () {
  var preloader = document.querySelector('.preloader__wrap_global');
  preloader.classList.add('hidden');
};
var setClickListenerForToggleHidden = function setClickListenerForToggleHidden(buttonClass, cardsClass) {
  var viewAllButtons = document.querySelectorAll("".concat(buttonClass));
  var hiddenWorks = document.querySelector("".concat(cardsClass)).querySelectorAll('.hidden');
  viewAllButtons = Array.from(viewAllButtons);
  viewAllButtons.forEach(function (button) {
    button.addEventListener('click', function () {
      hiddenWorks.forEach(function (element) {
        element.classList.toggle('hidden');
      });
      viewAllButtons.forEach(function (button) {
        button.classList.toggle('hidden');
      });
    });
  });
};
setClickListenerForToggleHidden('.js-commercial-project-button', '.js-commercial-project-cards');
setClickListenerForToggleHidden('.js-test-task-button', '.js-test-task-cards');
setClickListenerForToggleHidden('.js-pet-project-button', '.js-pet-project-cards');
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNjcmlwdC9naXQuanMiLCJzY3JpcHQvaGVhZGVyLmpzIiwic2NyaXB0L3ByZWxvYWRlci5qcyIsInNjcmlwdC9yZWNlbnRXb3Jrcy5qcyJdLCJuYW1lcyI6WyJ1c2VybmFtZSIsImxpbmtUb015R2l0IiwiY29uY2F0IiwibnVtUmVwb3MiLCJyZXBvc1BlclBhZ2UiLCJwYWdlRm9yTG9hZCIsImdldFJlcG9zIiwiZ29QYWdpbmF0aW9uIiwicHJlbG9hZGVyIiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwiY2xhc3NMaXN0IiwicmVtb3ZlIiwibGlua1RvTXlSZXBvcyIsImZldGNoIiwidGhlbiIsInJlc3BvbnNlIiwic3RhdHVzIiwianNvbiIsImFsZXJ0IiwiYXJyIiwiZm9yRWFjaCIsImVsZW1lbnQiLCJnaXRJdGVtQ3JlYXRvciIsImFkZCIsInB1YmxpY19yZXBvcyIsIm51bVBhZ2VzIiwiTWF0aCIsImNlaWwiLCJpIiwiY3JlYXRlUGFnaW5hdGlvbiIsImNvbnRhaW5lciIsIml0ZW0iLCJjcmVhdGVFbGVtZW50IiwibGluayIsImhyZWYiLCJodG1sX3VybCIsInRhcmdldCIsInRpdGxlIiwiaW5uZXJIVE1MIiwibmFtZSIsInN0cmluZyIsIm1hcmtlciIsImxhbmd1YWdlIiwicHJvZ0xhbmciLCJzdGFyV3JhcCIsInN0YXIiLCJmb3JrV3JhcCIsImZvcmsiLCJkYXRlVXBkYXRlIiwiRGF0ZSIsInVwZGF0ZWRfYXQiLCJ0b0xvY2FsZURhdGVTdHJpbmciLCJhcHBlbmRDaGlsZCIsInN0YXJnYXplcnNfY291bnQiLCJjcmVhdGVUZXh0Tm9kZSIsImZvcmtzX2NvdW50IiwicGFnZUNvdW50IiwicGFnaW5hdG9yIiwicGFnaW5hdGlvbkl0ZW0iLCJjbG9uZU5vZGUiLCJhZGRFdmVudExpc3RlbmVyIiwiZSIsImNsYXNzTmFtZSIsImFsbFJlcG9zIiwicXVlcnlTZWxlY3RvckFsbCIsIkFycmF5IiwiZnJvbSIsInBhZ2UiLCJpbm5lclRleHQiLCJwYWdpbmF0aW9uSXRlbXMiLCJ0YWciLCJidXJnZXIiLCJidXJnZXJJdGVtMSIsImJ1cmdlckl0ZW0yIiwibW9iaWxlTWVudSIsIm1haW4iLCJmb290ZXIiLCJ0b2dnbGUiLCJib2R5IiwiY29udGFpbnMiLCJzY3JvbGwiLCJwcm9ncmVzcyIsImxlbmdodFN0ZXAiLCJzZXRUaW1lb3V0Iiwid2luZG93Iiwic2Nyb2xsVG8iLCJjb3VudFN0ZXAiLCJudW1TdGVwIiwidGFyZ2V0Q2xhc3MiLCJkYXRhc2V0IiwiYWltQmxvY2siLCJmaW5pc2giLCJvZmZzZXRUb3AiLCJzdGFydCIsInBhZ2VZT2Zmc2V0Iiwib25sb2FkIiwic2V0Q2xpY2tMaXN0ZW5lckZvclRvZ2dsZUhpZGRlbiIsImJ1dHRvbkNsYXNzIiwiY2FyZHNDbGFzcyIsInZpZXdBbGxCdXR0b25zIiwiaGlkZGVuV29ya3MiLCJidXR0b24iXSwibWFwcGluZ3MiOiI7O0FBQUEsSUFBQUEsUUFBQSxHQUFBLFlBQUE7QUFDQSxJQUFBQyxXQUFBLG1DQUFBQyxNQUFBLENBQUFGLFFBQUEsQ0FBQTtBQUNBLElBQUFHLFFBQUEsR0FBQSxFQUFBO0FBQ0EsSUFBQUMsWUFBQSxHQUFBLEVBQUE7QUFDQSxJQUFBQyxXQUFBLEdBQUEsQ0FBQTtBQUVBQyxRQUFBLENBQUFELFdBQUEsQ0FBQTtBQUNBRSxZQUFBLENBQUEsQ0FBQTtBQUVBLFNBQUFELFFBQUFBLENBQUFELFdBQUEsRUFBQTtFQUVBLElBQUFHLFNBQUEsR0FBQUMsUUFBQSxDQUFBQyxhQUFBLENBQUEsc0JBQUEsQ0FBQTtFQUNBRixTQUFBLENBQUFHLFNBQUEsQ0FBQUMsTUFBQSxDQUFBLFFBQUEsQ0FBQTtFQUVBLElBQUFDLGFBQUEsTUFBQVgsTUFBQSxDQUFBRCxXQUFBLHNCQUFBQyxNQUFBLENBQUFFLFlBQUEsWUFBQUYsTUFBQSxDQUFBRyxXQUFBLENBQUE7RUFDQVMsS0FBQSxDQUFBRCxhQUFBLENBQUEsQ0FDQUUsSUFBQSxDQUFBLFVBQUFDLFFBQUEsRUFBQTtJQUNBLElBQUFBLFFBQUEsQ0FB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LE1BQUEsRUFBQTtRQUNBQSxNQUFBLENBQUEzRixTQUFBLENBQUFtRSxNQUFBLENBQUEsUUFBQSxDQUFBO01BQ0EsQ0FBQSxDQUFBO0lBQ0EsQ0FBQSxDQUFBO0VBQ0EsQ0FBQSxDQUFBO0FBQ0EsQ0FBQTtBQUVBbUIsK0JBQUEsQ0FBQSwrQkFBQSxFQUFBLDhCQUFBLENBQUE7QUFDQUEsK0JBQUEsQ0FBQSxzQkFBQSxFQUFBLHFCQUFBLENBQUE7QUFDQUEsK0JBQUEsQ0FBQSx3QkFBQSxFQUFBLHVCQUFBLENBQUEiLCJmaWxlIjoic2NyaXB0Lm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbImNvbnN0IHVzZXJuYW1lID0gJ3N0YXNva3Vsb3YnO1xyXG5sZXQgbGlua1RvTXlHaXQgPSBgaHR0cHM6Ly9hcGkuZ2l0aHViLmNvbS91c2Vycy8ke3VzZXJuYW1lfWA7XHJcbmxldCBudW1SZXBvcyA9ICcnO1xyXG5sZXQgcmVwb3NQZXJQYWdlID0gMTA7XHJcbmxldCBwYWdlRm9yTG9hZCA9IDE7XHJcblxyXG5nZXRSZXBvcyhwYWdlRm9yTG9hZCk7XHJcbmdvUGFnaW5hdGlvbigpO1xyXG5cclxuZnVuY3Rpb24gZ2V0UmVwb3MocGFnZUZvckxvYWQpIHtcclxuXHJcbiAgICBsZXQgcHJlbG9hZGVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnByZWxvYWRlcl9fd3JhcF9naXQnKTtcclxuICAgIHByZWxvYWRlci5jbGFzc0xpc3QucmVtb3ZlKCdoaWRkZW4nKTtcclxuXHJcbiAgICBsZXQgbGlua1RvTXlSZXBvcyA9IGAke2xpbmtUb015R2l0fS9yZXBvcz9wZXJfcGFnZT0ke3JlcG9zUGVyUGFnZX0mcGFnZT0ke3BhZ2VGb3JMb2FkfWA7XHJcbiAgICBmZXRjaChsaW5rVG9NeVJlcG9zKSBcclxuICAgIC50aGVuKHJlc3BvbnNlID0+IHtcclxuICAgICAgICBpZiAocmVzcG9uc2Uuc3RhdHVzID09PSAyMDApIHtcclxuICAgICAgICAgICAgcmV0dXJuIHJlc3BvbnNlLmpzb24oKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBhbGVydCgn0JfQsNC/0YDQvtGBINC90LAgZ2l0aHViLmNvbSDQvdC1INGD0LTQsNC70YHRjy4g0J7RiNC40LHQutCwOiAnICsgcmVzcG9uc2Uuc3RhdHVzKTtcclxuICAgICAgICB9XHJcbiAgICB9KVxyXG4gICAgLnRoZW4oYXJyID0+IHtcclxuICAgICAgICBhcnIuZm9yRWFjaCggKGVsZW1lbnQpID0+IHtcclxuICAgICAgICAgICAgZ2l0SXRlbUNyZWF0b3IoZWxlbWVudCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9KVxyXG4gICAgLnRoZW4oICgpID0+IHtcclxuICAgICAgICBwcmVsb2FkZXIuY2xhc3NMaXN0LmFkZCgnaGlkZGVuJyk7XHJcbiAgICB9KTtcclxufTtcclxuXHJcbmZldGNoKGxpbmtUb015R2l0KVxyXG4gICAgLnRoZW4ocmVzcG9uc2UgPT4ge1xyXG4gICAgICAgIGlmIChyZXNwb25zZS5zdGF0dXMgPT09IDIwMCkge1xyXG4gICAgICAgICAgICByZXR1cm4gcmVzcG9uc2UuanNvbigpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGFsZXJ0KCfQl9Cw0L/RgNC+0YEg0L3QsCBnaXRodWIuY29tINC90LUg0YPQtNCw0LvRgdGPLiDQntGI0LjQsdC60LA6ICcgKyByZXNwb25zZS5zdGF0dXMpO1xyXG4gICAgICAgIH1cclxuICAgIH0pXHJcbiAgICAudGhlbihqc29uID0+IHtcclxuICAgICAgICBudW1SZXBvcyA9IGpzb24ucHVibGljX3JlcG9zO1xyXG4gICAgICAgIHJldHVybiBudW1SZXBvczsgICAgICAgICAgIFxyXG4gICAgfSlcclxuICAgIC50aGVuKG51bVJlcG9zID0+IHtcclxuICAgICAgICBsZXQgbnVtUGFnZXMgPSBNYXRoLmNlaWwobnVtUmVwb3MvcmVwb3NQZXJQYWdlKTtcclxuICAgICAgICBmb3IobGV0IGkgPSAxOyBpIDw9IG51bVBhZ2VzOyBpKyspIHtcclxuICAgICAgICAgICAgY3JlYXRlUGFnaW5hdGlvbihpKTtcclxuICAgICAgICB9O1xyXG4gICAgfSk7XHJcblxyXG5mdW5jdGlvbiBnaXRJdGVtQ3JlYXRvcihlbGVtZW50KSB7XHJcbiAgICBjb25zdCBjb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuZ2l0X19saXN0Jyk7XHJcblxyXG4gICAgY29uc3QgaXRlbSA9IGNyZWF0ZUVsZW1lbnQoJ2xpJyk7XHJcbiAgICBpdGVtLmNsYXNzTGlzdC5hZGQoJ2dpdF9fbWFpbl9faXRlbScpO1xyXG5cclxuICAgIGNvbnN0IGxpbmsgPSBjcmVhdGVFbGVtZW50KCdhJyk7XHJcbiAgICBsaW5rLmNsYXNzTGlzdC5hZGQoJ2dpdF9faXRlbS1pbm5lcldyYXAnKTtcclxuICAgIGxpbmsuY2xhc3NMaXN0LmFkZCgnbGluaycpO1xyXG4gICAgbGluay5ocmVmID0gZWxlbWVudC5odG1sX3VybDtcclxuICAgIGxpbmsudGFyZ2V0ID0gJ2JsYW5rJztcclxuXHJcbiAgICBjb25zdCB0aXRsZSA9IGNyZWF0ZUVsZW1lbnQoJ3AnKTtcclxuICAgIHRpdGxlLmNsYXNzTGlzdC5hZGQoJ2dpdF9faXRlbS10aXRsZScpO1xyXG4gICAgdGl0bGUuaW5uZXJIVE1MID0gZWxlbWVudC5uYW1lO1xyXG5cclxuICAgIGNvbnN0IHN0cmluZyA9IGNyZWF0ZUVsZW1lbnQoJ3AnKTtcclxuICAgIHN0cmluZy5jbGFzc0xpc3QuYWRkKCdnaXRfX2l0ZW0tdGV4dCcpO1xyXG5cclxuICAgIGNvbnN0IG1hcmtlciA9IGNyZWF0ZUVsZW1lbnQoJ3NwYW4nKTtcclxuICAgIG1hcmtlci5jbGFzc0xpc3QuYWRkKCdtYXJrZXInKTtcclxuICAgIHN3aXRjaChlbGVtZW50Lmxhbmd1YWdlKSB7XHJcbiAgICAgICAgY2FzZSAnSFRNTCc6XHJcbiAgICAgICAgICAgIG1hcmtlci5jbGFzc0xpc3QuYWRkKCdtYXJrZXJfSFRNTCcpO1xyXG4gICAgICAgICAgICBicmVhaztcclxuICAgICAgICBjYXNlICdDU1MnOlxyXG4gICAgICAgICAgICBtYXJrZXIuY2xhc3NMaXN0LmFkZCgnbWFya2VyX0NTUycpO1xyXG4gICAgICAgICAgICBicmVhaztcclxuICAgICAgICBjYXNlICdKUyc6XHJcbiAgICAgICAgICAgIG1hcmtlci5jbGFzc0xpc3QuYWRkKCdtYXJrZXJfSlMnKTtcclxuICAgICAgICAgICAgYnJlYWs7XHJcbiAgICB9O1xyXG5cclxuICAgIGNvbnN0IHByb2dMYW5nID0gY3JlYXRlRWxlbWVudCgnc3BhbicpO1xyXG4gICAgcHJvZ0xhbmcuY2xhc3NMaXN0LmFkZCgndGV4dC1lbGVtZW50Jyk7XHJcbiAgICBwcm9nTGFuZy5jbGFzc0xpc3QuYWRkKCd0ZXh0LWVsZW1lbnRfcHJvZ0xhbmcnKTtcclxuICAgIHByb2dMYW5nLmlubmVySFRNTCA9IGVsZW1lbnQubGFuZ3VhZ2U7XHJcblxyXG4gICAgY29uc3Qgc3RhcldyYXAgPSBjcmVhdGVFbGVtZW50KCdzcGFuJyk7XHJcbiAgICBzdGFyV3JhcC5jbGFzc0xpc3QuYWRkKCd0ZXh0LWVsZW1lbnQnKTtcclxuXHJcbiAgICBjb25zdCBzdGFyID0gY3JlYXRlRWxlbWVudCgnc3BhbicpO1xyXG4gICAgc3Rhci5jbGFzc0xpc3QuYWRkKCd0ZXh0LWVsZW1lbnRfc3RhcicpO1xyXG5cclxuICAgIGNvbnN0IGZvcmtXcmFwID0gY3JlYXRlRWxlbWVudCgnc3BhbicpO1xyXG4gICAgZm9ya1dyYXAuY2xhc3NMaXN0LmFkZCgndGV4dC1lbGVtZW50Jyk7XHJcblxyXG4gICAgY29uc3QgZm9yayA9IGNyZWF0ZUVsZW1lbnQoJ3NwYW4nKTtcclxuICAgIGZvcmsuY2xhc3NMaXN0LmFkZCgndGV4dC1lbGVtZW50X2ZvcmsnKTtcclxuXHJcbiAgICBjb25zdCBkYXRlVXBkYXRlID0gY3JlYXRlRWxlbWVudCgnc3BhbicpO1xyXG4gICAgZGF0ZVVwZGF0ZS5jbGFzc0xpc3QuYWRkKCd0ZXh0LWVsZW1lbnQnKTtcclxuICAgIGRhdGVVcGRhdGUuY2xhc3NMaXN0LmFkZCgndGV4dC1lbGVtZW50X3VwZGF0ZScpO1xyXG4gICAgZGF0ZVVwZGF0ZS5pbm5lckhUTUwgPSAn0J7QsdC90L7QstC70LXQvdC+ICcgKyBuZXcgRGF0ZShlbGVtZW50LnVwZGF0ZWRfYXQpLnRvTG9jYWxlRGF0ZVN0cmluZygncnUnKSArICfQsy4nO1xyXG5cclxuICAgIHN0YXJXcmFwLmFwcGVuZENoaWxkKHN0YXIpO1xyXG4gICAgZm9ya1dyYXAuYXBwZW5kQ2hpbGQoZm9yayk7XHJcblxyXG4gICAgc3RyaW5nLmFwcGVuZENoaWxkKG1hcmtlcik7XHJcbiAgICBzdHJpbmcuYXBwZW5kQ2hpbGQocHJvZ0xhbmcpO1xyXG4gICAgc3RyaW5nLmFwcGVuZENoaWxkKHN0YXJXcmFwKTtcclxuICAgIHN0cmluZy5hcHBlbmRDaGlsZChmb3JrV3JhcCk7XHJcbiAgICBzdHJpbmcuYXBwZW5kQ2hpbGQoZGF0ZVVwZGF0ZSk7XHJcblxyXG4gICAgbGluay5hcHBlbmRDaGlsZCh0aXRsZSk7XHJcbiAgICBsaW5rLmFwcGVuZENoaWxkKHN0cmluZyk7XHJcblxyXG4gICAgaXRlbS5hcHBlbmRDaGlsZChsaW5rKTtcclxuXHJcbiAgICBpZihlbGVtZW50LnN0YXJnYXplcnNfY291bnQpIHtcclxuICAgICAgICBzdGFyV3JhcC5hcHBlbmRDaGlsZCggZG9jdW1lbnQuY3JlYXRlVGV4dE5vZGUoZWxlbWVudC5zdGFyZ2F6ZXJzX2NvdW50KSApO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgICBzdGFyV3JhcC5yZW1vdmUoKTtcclxuICAgIH07XHJcblxyXG4gICAgaWYoZWxlbWVudC5mb3Jrc19jb3VudCkge1xyXG4gICAgICAgIGZvcmsuYXBwZW5kQ2hpbGQoIGRvY3VtZW50LmNyZWF0ZVRleHROb2RlKGVsZW1lbnQuZm9ya3NfY291bnQpICk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAgIGZvcmsucmVtb3ZlKCk7XHJcbiAgICB9O1xyXG5cclxuICAgIGNvbnRhaW5lci5hcHBlbmRDaGlsZChpdGVtKTtcclxufTtcclxuXHJcbmZ1bmN0aW9uIGNyZWF0ZVBhZ2luYXRpb24ocGFnZUNvdW50KSB7XHJcbiAgICBsZXQgcGFnaW5hdG9yID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnBhZ2luYXRvcicpO1xyXG4gICAgbGV0IHBhZ2luYXRpb25JdGVtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnBhZ2luYXRvcl9faXRlbScpLmNsb25lTm9kZSh0cnVlKTtcclxuICAgIHBhZ2luYXRpb25JdGVtLmNsYXNzTGlzdC5yZW1vdmUoJ2hpZGRlbicpO1xyXG4gICAgaWYocGFnZUNvdW50ID09PSAxKSB7XHJcbiAgICAgICAgcGFnaW5hdGlvbkl0ZW0uY2xhc3NMaXN0LmFkZCgncGFnaW5hdG9yX19pdGVtX2FjdGl2ZScpO1xyXG4gICAgfTtcclxuICAgIHBhZ2luYXRpb25JdGVtLmFwcGVuZENoaWxkKCBkb2N1bWVudC5jcmVhdGVUZXh0Tm9kZShwYWdlQ291bnQpICk7XHJcbiAgICBwYWdpbmF0b3IuYXBwZW5kQ2hpbGQoIHBhZ2luYXRpb25JdGVtICk7XHJcbn07XHJcblxyXG5mdW5jdGlvbiBnb1BhZ2luYXRpb24oKSB7XHJcbiAgICBsZXQgcGFnaW5hdG9yID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnBhZ2luYXRvcicpO1xyXG4gICAgcGFnaW5hdG9yLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGUpID0+IHtcclxuICAgICAgICBpZihlLnRhcmdldC5jbGFzc05hbWUgPT09ICdwYWdpbmF0b3JfX2l0ZW0nKSB7XHJcblxyXG4gICAgICAgICAgICBsZXQgYWxsUmVwb3MgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuZ2l0X19tYWluX19pdGVtJyk7XHJcbiAgICAgICAgICAgIGFsbFJlcG9zID0gQXJyYXkuZnJvbShhbGxSZXBvcyk7XHJcbiAgICAgICAgICAgIGFsbFJlcG9zLmZvckVhY2goZWxlbWVudCA9PiB7XHJcbiAgICAgICAgICAgICAgICBlbGVtZW50LnJlbW92ZSgpO1xyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIGxldCBwYWdlID0gZS50YXJnZXQuaW5uZXJUZXh0O1xyXG4gICAgICAgICAgICBnZXRSZXBvcyhwYWdlKTtcclxuXHJcbiAgICAgICAgICAgIGxldCBwYWdpbmF0aW9uSXRlbXMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcucGFnaW5hdG9yX19pdGVtJyk7XHJcbiAgICAgICAgICAgIHBhZ2luYXRpb25JdGVtcyA9IEFycmF5LmZyb20ocGFnaW5hdGlvbkl0ZW1zKTtcclxuICAgICAgICAgICAgcGFnaW5hdGlvbkl0ZW1zLmZvckVhY2goZWxlbWVudCA9PiB7XHJcbiAgICAgICAgICAgICAgICBlbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoJ3BhZ2luYXRvcl9faXRlbV9hY3RpdmUnKTsgICAgICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIGUudGFyZ2V0LmNsYXNzTGlzdC5hZGQoJ3BhZ2luYXRvcl9faXRlbV9hY3RpdmUnKTtcclxuICAgICAgICB9O1xyXG4gICAgfSk7XHJcbn07XHJcblxyXG5mdW5jdGlvbiBjcmVhdGVFbGVtZW50KHRhZykge1xyXG4gICAgY29uc3QgZWxlbWVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQodGFnKTtcclxuICAgIHJldHVybiBlbGVtZW50O1xyXG59OyIsImxldCBidXJnZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuYnVyZ2VyJyk7XHJcbmxldCBidXJnZXJJdGVtMSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5idXJnZXJfX2l0ZW0tMScpO1xyXG5sZXQgYnVyZ2VySXRlbTIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuYnVyZ2VyX19pdGVtLTInKTtcclxubGV0IG1vYmlsZU1lbnUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuaGVhZGVyX19tb2JpbGVNZW51Jyk7XHJcbmxldCBtYWluID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignbWFpbicpO1xyXG5sZXQgZm9vdGVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmZvb3Rlcl9fd3JhcCcpO1xyXG5idXJnZXIuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XHJcbiAgICBidXJnZXJJdGVtMS5jbGFzc0xpc3QudG9nZ2xlKCdidXJnZXJfX2l0ZW0tMV9hY3RpdmUnKTtcclxuICAgIGJ1cmdlckl0ZW0yLmNsYXNzTGlzdC50b2dnbGUoJ2J1cmdlcl9faXRlbS0yX2FjdGl2ZScpO1xyXG4gICAgbW9iaWxlTWVudS5jbGFzc0xpc3QudG9nZ2xlKCdoaWRkZW4nKTtcclxuICAgIG1haW4uY2xhc3NMaXN0LnRvZ2dsZSgnaGlkZGVuJyk7XHJcbiAgICBmb290ZXIuY2xhc3NMaXN0LnRvZ2dsZSgnaGlkZGVuJyk7XHJcbn0pO1xyXG5cclxubGV0IGJvZHkgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdib2R5Jyk7XHJcbmJvZHkuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZSkgPT4ge1xyXG4gICAgaWYoIGUudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucygnc2Nyb2xsJykgKSB7XHJcblxyXG4gICAgICAgIGJ1cmdlckl0ZW0xLmNsYXNzTGlzdC5yZW1vdmUoJ2J1cmdlcl9faXRlbS0xX2FjdGl2ZScpO1xyXG4gICAgICAgIGJ1cmdlckl0ZW0yLmNsYXNzTGlzdC5yZW1vdmUoJ2J1cmdlcl9faXRlbS0yX2FjdGl2ZScpO1xyXG4gICAgICAgIG1vYmlsZU1lbnUuY2xhc3NMaXN0LmFkZCgnaGlkZGVuJyk7XHJcbiAgICAgICAgbWFpbi5jbGFzc0xpc3QucmVtb3ZlKCdoaWRkZW4nKTtcclxuICAgICAgICBmb290ZXIuY2xhc3NMaXN0LnJlbW92ZSgnaGlkZGVuJyk7XHJcblxyXG4gICAgICAgIGxldCB0YXJnZXRDbGFzcyA9IGUudGFyZ2V0LmRhdGFzZXQudGFyZ2V0O1xyXG4gICAgICAgIGxldCBhaW1CbG9jayA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy4nICsgdGFyZ2V0Q2xhc3MpO1xyXG4gICAgICAgIGxldCBmaW5pc2ggPSBhaW1CbG9jay5vZmZzZXRUb3A7XHJcbiAgICAgICAgbGV0IHN0YXJ0ID0gd2luZG93LnBhZ2VZT2Zmc2V0O1xyXG4gICAgICAgIGxldCBudW1TdGVwID0gNTA7XHJcbiAgICAgICAgbGV0IGxlbmdodFN0ZXAgPSAoZmluaXNoLXN0YXJ0KS9udW1TdGVwO1xyXG4gICAgICAgIGxldCBwcm9ncmVzcyA9IHN0YXJ0O1xyXG4gICAgICAgIGxldCBjb3VudFN0ZXAgPSAwO1xyXG5cclxuICAgICAgICBzY3JvbGwoKTtcclxuXHJcbiAgICAgICAgZnVuY3Rpb24gc2Nyb2xsKCkge1xyXG4gICAgICAgICAgICBwcm9ncmVzcyArPSBsZW5naHRTdGVwO1xyXG4gICAgICAgICAgICBzZXRUaW1lb3V0KCAoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICB3aW5kb3cuc2Nyb2xsVG8oMCwgcHJvZ3Jlc3MpO1xyXG4gICAgICAgICAgICAgICAgY291bnRTdGVwKys7XHJcbiAgICAgICAgICAgICAgICBpZihjb3VudFN0ZXAgPCBudW1TdGVwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgc2Nyb2xsKCk7XHJcbiAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICB9LCAxMCk7XHJcbiAgICAgICAgfTtcclxuICAgIH07XHJcbn0pOyIsIndpbmRvdy5vbmxvYWQgPSAoKSA9PiB7XHJcbiAgICBsZXQgcHJlbG9hZGVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnByZWxvYWRlcl9fd3JhcF9nbG9iYWwnKTtcclxuICAgIHByZWxvYWRlci5jbGFzc0xpc3QuYWRkKCdoaWRkZW4nKTtcclxuICB9OyIsImNvbnN0IHNldENsaWNrTGlzdGVuZXJGb3JUb2dnbGVIaWRkZW4gPSAoYnV0dG9uQ2xhc3MsIGNhcmRzQ2xhc3MpID0+IHtcclxuICAgIGxldCB2aWV3QWxsQnV0dG9ucyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoYCR7YnV0dG9uQ2xhc3N9YCk7XHJcbiAgICBsZXQgaGlkZGVuV29ya3MgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGAke2NhcmRzQ2xhc3N9YCkucXVlcnlTZWxlY3RvckFsbCgnLmhpZGRlbicpO1xyXG4gICAgXHJcbiAgICB2aWV3QWxsQnV0dG9ucyA9IEFycmF5LmZyb20odmlld0FsbEJ1dHRvbnMpO1xyXG4gICAgdmlld0FsbEJ1dHRvbnMuZm9yRWFjaChidXR0b24gPT4ge1xyXG4gICAgICAgIGJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcclxuICAgICAgICAgICAgaGlkZGVuV29ya3MuZm9yRWFjaChlbGVtZW50ID0+IHtcclxuICAgICAgICAgICAgICAgIGVsZW1lbnQuY2xhc3NMaXN0LnRvZ2dsZSgnaGlkZGVuJyk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB2aWV3QWxsQnV0dG9ucy5mb3JFYWNoKGJ1dHRvbiA9PiB7XHJcbiAgICAgICAgICAgICAgICBidXR0b24uY2xhc3NMaXN0LnRvZ2dsZSgnaGlkZGVuJyk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfSk7XHJcbn07XHJcblxyXG5zZXRDbGlja0xpc3RlbmVyRm9yVG9nZ2xlSGlkZGVuKCcuanMtY29tbWVyY2lhbC1wcm9qZWN0LWJ1dHRvbicsICcuanMtY29tbWVyY2lhbC1wcm9qZWN0LWNhcmRzJyk7XHJcbnNldENsaWNrTGlzdGVuZXJGb3JUb2dnbGVIaWRkZW4oJy5qcy10ZXN0LXRhc2stYnV0dG9uJywgJy5qcy10ZXN0LXRhc2stY2FyZHMnKTtcclxuc2V0Q2xpY2tMaXN0ZW5lckZvclRvZ2dsZUhpZGRlbignLmpzLXBldC1wcm9qZWN0LWJ1dHRvbicsICcuanMtcGV0LXByb2plY3QtY2FyZHMnKTtcclxuXHJcbiJdfQ==
