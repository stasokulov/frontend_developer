"use strict";

var username = 'stasokulov';
var linkToMyGit = "https://api.github.com/users/".concat(username);
var numRepos = '';
var reposPerPage = 10;
var pageForLoad = 1;
getRepos(pageForLoad);
goPagination();

function getRepos(pageForLoad) {
  var preloader = document.querySelector('.preloader__wrap_git');
  preloader.classList.remove('hidden');
  var linkToMyRepos = "".concat(linkToMyGit, "/repos?per_page=").concat(reposPerPage, "&page=").concat(pageForLoad);
  fetch(linkToMyRepos).then(function (response) {
    if (response.status === 200) {
      return response.json();
    } else {
      alert('Запрос на github.com не удался. Ошибка: ' + response.status);
    }
  }).then(function (arr) {
    arr.forEach(function (element) {
      gitItemCreator(element);
    });
  }).then(function () {
    preloader.classList.add('hidden');
  });
}

;
fetch(linkToMyGit).then(function (response) {
  if (response.status === 200) {
    return response.json();
  } else {
    alert('Запрос на github.com не удался. Ошибка: ' + response.status);
  }
}).then(function (json) {
  numRepos = json.public_repos;
  return numRepos;
}).then(function (numRepos) {
  var numPages = Math.ceil(numRepos / reposPerPage);

  for (var i = 1; i <= numPages; i++) {
    createPagination(i);
  }

  ;
});

function gitItemCreator(element) {
  var container = document.querySelector('.git__list');
  var item = createElement('li');
  item.classList.add('git__main__item');
  var link = createElement('a');
  link.classList.add('git__item-innerWrap');
  link.classList.add('link');
  link.href = element.html_url;
  link.target = 'blank';
  var title = createElement('p');
  title.classList.add('git__item-title');
  title.innerHTML = element.name;
  var string = createElement('p');
  string.classList.add('git__item-text');
  var marker = createElement('span');
  marker.classList.add('marker');

  switch (element.language) {
    case 'HTML':
      marker.classList.add('marker_HTML');
      break;

    case 'CSS':
      marker.classList.add('marker_CSS');
      break;

    case 'JS':
      marker.classList.add('marker_JS');
      break;
  }

  ;
  var progLang = createElement('span');
  progLang.classList.add('text-element');
  progLang.classList.add('text-element_progLang');
  progLang.innerHTML = element.language;
  var starWrap = createElement('span');
  starWrap.classList.add('text-element');
  var star = createElement('span');
  star.classList.add('text-element_star');
  var forkWrap = createElement('span');
  forkWrap.classList.add('text-element');
  var fork = createElement('span');
  fork.classList.add('text-element_fork');
  var dateUpdate = createElement('span');
  dateUpdate.classList.add('text-element');
  dateUpdate.classList.add('text-element_update');
  dateUpdate.innerHTML = 'Обновлено ' + new Date(element.updated_at).toLocaleDateString('ru') + 'г.';
  starWrap.appendChild(star);
  forkWrap.appendChild(fork);
  string.appendChild(marker);
  string.appendChild(progLang);
  string.appendChild(starWrap);
  string.appendChild(forkWrap);
  string.appendChild(dateUpdate);
  link.appendChild(title);
  link.appendChild(string);
  item.appendChild(link);

  if (element.stargazers_count) {
    starWrap.appendChild(document.createTextNode(element.stargazers_count));
  } else {
    starWrap.remove();
  }

  ;

  if (element.forks_count) {
    fork.appendChild(document.createTextNode(element.forks_count));
  } else {
    fork.remove();
  }

  ;
  container.appendChild(item);
}

;

function createPagination(pageCount) {
  var paginator = document.querySelector('.paginator');
  var paginationItem = document.querySelector('.paginator__item').cloneNode(true);
  paginationItem.classList.remove('hidden');

  if (pageCount === 1) {
    paginationItem.classList.add('paginator__item_active');
  }

  ;
  paginationItem.appendChild(document.createTextNode(pageCount));
  paginator.appendChild(paginationItem);
}

;

function goPagination() {
  var paginator = document.querySelector('.paginator');
  paginator.addEventListener('click', function (e) {
    if (e.target.className === 'paginator__item') {
      var allRepos = document.querySelectorAll('.git__main__item');
      allRepos = Array.from(allRepos);
      allRepos.forEach(function (element) {
        element.remove();
      });
      var page = e.target.innerText;
      getRepos(page);
      var paginationItems = document.querySelectorAll('.paginator__item');
      paginationItems = Array.from(paginationItems);
      paginationItems.forEach(function (element) {
        element.classList.remove('paginator__item_active');
      });
      e.target.classList.add('paginator__item_active');
    }

    ;
  });
}

;

function createElement(tag) {
  var element = document.createElement(tag);
  return element;
}

;
var burger = document.querySelector('.burger');
var burgerItem1 = document.querySelector('.burger__item-1');
var burgerItem2 = document.querySelector('.burger__item-2');
var mobileMenu = document.querySelector('.header__mobileMenu');
var main = document.querySelector('main');
var footer = document.querySelector('.footer__wrap');
burger.addEventListener('click', function () {
  burgerItem1.classList.toggle('burger__item-1_active');
  burgerItem2.classList.toggle('burger__item-2_active');
  mobileMenu.classList.toggle('hidden');
  main.classList.toggle('hidden');
  footer.classList.toggle('hidden');
});
var body = document.querySelector('body');
body.addEventListener('click', function (e) {
  if (e.target.classList.contains('scroll')) {
    var scroll = function scroll() {
      progress += lenghtStep;
      setTimeout(function () {
        window.scrollTo(0, progress);
        countStep++;

        if (countStep < numStep) {
          scroll();
        }

        ;
      }, 10);
    };

    burgerItem1.classList.remove('burger__item-1_active');
    burgerItem2.classList.remove('burger__item-2_active');
    mobileMenu.classList.add('hidden');
    main.classList.remove('hidden');
    footer.classList.remove('hidden');
    var targetClass = e.target.dataset.target;
    var aimBlock = document.querySelector('.' + targetClass);
    var finish = aimBlock.offsetTop;
    var start = window.pageYOffset;
    var numStep = 50;
    var lenghtStep = (finish - start) / numStep;
    var progress = start;
    var countStep = 0;
    scroll();
    ;
  }

  ;
});

window.onload = function () {
  var preloader = document.querySelector('.preloader__wrap_global');
  preloader.classList.add('hidden');
};

var viewAll = document.querySelectorAll('.recentWorks__title-side');
var hiddenWorks = document.querySelector('.recentWorks__example').querySelectorAll('.hidden');
viewAll = Array.from(viewAll);
viewAll.forEach(function (button) {
  button.addEventListener('click', function () {
    hiddenWorks.forEach(function (element) {
      element.classList.toggle('hidden');
    });
    viewAll.forEach(function (button) {
      button.classList.toggle('hidden');
    });
  });
});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNjcmlwdC9naXQuanMiLCJzY3JpcHQvaGVhZGVyLmpzIiwic2NyaXB0L3ByZWxvYWRlci5qcyIsInNjcmlwdC9yZWNlbnRXb3Jrcy5qcyJdLCJuYW1lcyI6WyJ1c2VybmFtZSIsImxpbmtUb015R2l0IiwibnVtUmVwb3MiLCJyZXBvc1BlclBhZ2UiLCJwYWdlRm9yTG9hZCIsImdldFJlcG9zIiwiZ29QYWdpbmF0aW9uIiwicHJlbG9hZGVyIiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwiY2xhc3NMaXN0IiwicmVtb3ZlIiwibGlua1RvTXlSZXBvcyIsImZldGNoIiwidGhlbiIsInJlc3BvbnNlIiwic3RhdHVzIiwianNvbiIsImFsZXJ0IiwiYXJyIiwiZm9yRWFjaCIsImVsZW1lbnQiLCJnaXRJdGVtQ3JlYXRvciIsImFkZCIsInB1YmxpY19yZXBvcyIsIm51bVBhZ2VzIiwiTWF0aCIsImNlaWwiLCJpIiwiY3JlYXRlUGFnaW5hdGlvbiIsImNvbnRhaW5lciIsIml0ZW0iLCJjcmVhdGVFbGVtZW50IiwibGluayIsImhyZWYiLCJodG1sX3VybCIsInRhcmdldCIsInRpdGxlIiwiaW5uZXJIVE1MIiwibmFtZSIsInN0cmluZyIsIm1hcmtlciIsImxhbmd1YWdlIiwicHJvZ0xhbmciLCJzdGFyV3JhcCIsInN0YXIiLCJmb3JrV3JhcCIsImZvcmsiLCJkYXRlVXBkYXRlIiwiRGF0ZSIsInVwZGF0ZWRfYXQiLCJ0b0xvY2FsZURhdGVTdHJpbmciLCJhcHBlbmRDaGlsZCIsInN0YXJnYXplcnNfY291bnQiLCJjcmVhdGVUZXh0Tm9kZSIsImZvcmtzX2NvdW50IiwicGFnZUNvdW50IiwicGFnaW5hdG9yIiwicGFnaW5hdGlvbkl0ZW0iLCJjbG9uZU5vZGUiLCJhZGRFdmVudExpc3RlbmVyIiwiZSIsImNsYXNzTmFtZSIsImFsbFJlcG9zIiwicXVlcnlTZWxlY3RvckFsbCIsIkFycmF5IiwiZnJvbSIsInBhZ2UiLCJpbm5lclRleHQiLCJwYWdpbmF0aW9uSXRlbXMiLCJ0YWciLCJidXJnZXIiLCJidXJnZXJJdGVtMSIsImJ1cmdlckl0ZW0yIiwibW9iaWxlTWVudSIsIm1haW4iLCJmb290ZXIiLCJ0b2dnbGUiLCJib2R5IiwiY29udGFpbnMiLCJzY3JvbGwiLCJwcm9ncmVzcyIsImxlbmdodFN0ZXAiLCJzZXRUaW1lb3V0Iiwid2luZG93Iiwic2Nyb2xsVG8iLCJjb3VudFN0ZXAiLCJudW1TdGVwIiwidGFyZ2V0Q2xhc3MiLCJkYXRhc2V0IiwiYWltQmxvY2siLCJmaW5pc2giLCJvZmZzZXRUb3AiLCJzdGFydCIsInBhZ2VZT2Zmc2V0Iiwib25sb2FkIiwidmlld0FsbCIsImhpZGRlbldvcmtzIiwiYnV0dG9uIl0sIm1hcHBpbmdzIjoiOztBQUFBLElBQUFBLFFBQUEsR0FBQSxZQUFBO0FBQ0EsSUFBQUMsV0FBQSwwQ0FBQUQsUUFBQSxDQUFBO0FBQ0EsSUFBQUUsUUFBQSxHQUFBLEVBQUE7QUFDQSxJQUFBQyxZQUFBLEdBQUEsRUFBQTtBQUNBLElBQUFDLFdBQUEsR0FBQSxDQUFBO0FBRUFDLFFBQUEsQ0FBQUQsV0FBQSxDQUFBO0FBQ0FFLFlBQUE7O0FBRUEsU0FBQUQsUUFBQSxDQUFBRCxXQUFBLEVBQUE7QUFFQSxNQUFBRyxTQUFBLEdBQUFDLFFBQUEsQ0FBQUMsYUFBQSxDQUFBLHNCQUFBLENBQUE7QUFDQUYsRUFBQUEsU0FBQSxDQUFBRyxTQUFBLENBQUFDLE1BQUEsQ0FBQSxRQUFBO0FBRUEsTUFBQUMsYUFBQSxhQUFBWCxXQUFBLDZCQUFBRSxZQUFBLG1CQUFBQyxXQUFBLENBQUE7QUFDQVMsRUFBQUEsS0FBQSxDQUFBRCxhQUFBLENBQUEsQ0FDQUUsSUFEQSxDQUNBLFVBQUFDLFFBQUEsRUFBQTtBQUNBLFFBQUFBLFFBQUEsQ0FBQUMsTUFBQSxLQUFBLEdBQUEsRUFBQTtBQUNBLGFBQUFELFFBQUEsQ0FBQUUsSUFBQSxFQUFBO0FBQ0EsS0FGQSxNQUVBO0FBQ0FDLE1BQUFBLEtBQUEsQ0FBQSw2Q0FBQUgsUUFBQSxDQUFBQyxNQUFBLENBQUE7QUFD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YW1lID0gJ3N0YXNva3Vsb3YnO1xyXG5sZXQgbGlua1RvTXlHaXQgPSBgaHR0cHM6Ly9hcGkuZ2l0aHViLmNvbS91c2Vycy8ke3VzZXJuYW1lfWA7XHJcbmxldCBudW1SZXBvcyA9ICcnO1xyXG5sZXQgcmVwb3NQZXJQYWdlID0gMTA7XHJcbmxldCBwYWdlRm9yTG9hZCA9IDE7XHJcblxyXG5nZXRSZXBvcyhwYWdlRm9yTG9hZCk7XHJcbmdvUGFnaW5hdGlvbigpO1xyXG5cclxuZnVuY3Rpb24gZ2V0UmVwb3MocGFnZUZvckxvYWQpIHtcclxuXHJcbiAgICBsZXQgcHJlbG9hZGVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnByZWxvYWRlcl9fd3JhcF9naXQnKTtcclxuICAgIHByZWxvYWRlci5jbGFzc0xpc3QucmVtb3ZlKCdoaWRkZW4nKTtcclxuXHJcbiAgICBsZXQgbGlua1RvTXlSZXBvcyA9IGAke2xpbmtUb015R2l0fS9yZXBvcz9wZXJfcGFnZT0ke3JlcG9zUGVyUGFnZX0mcGFnZT0ke3BhZ2VGb3JMb2FkfWA7XHJcbiAgICBmZXRjaChsaW5rVG9NeVJlcG9zKSBcclxuICAgIC50aGVuKHJlc3BvbnNlID0+IHtcclxuICAgICAgICBpZiAocmVzcG9uc2Uuc3RhdHVzID09PSAyMDApIHtcclxuICAgICAgICAgICAgcmV0dXJuIHJlc3BvbnNlLmpzb24oKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBhbGVydCgn0JfQsNC/0YDQvtGBINC90LAgZ2l0aHViLmNvbSDQvdC1INGD0LTQsNC70YHRjy4g0J7RiNC40LHQutCwOiAnICsgcmVzcG9uc2Uuc3RhdHVzKTtcclxuICAgICAgICB9XHJcbiAgICB9KVxyXG4gICAgLnRoZW4oYXJyID0+IHtcclxuICAgICAgICBhcnIuZm9yRWFjaCggKGVsZW1lbnQpID0+IHtcclxuICAgICAgICAgICAgZ2l0SXRlbUNyZWF0b3IoZWxlbWVudCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9KVxyXG4gICAgLnRoZW4oICgpID0+IHtcclxuICAgICAgICBwcmVsb2FkZXIuY2xhc3NMaXN0LmFkZCgnaGlkZGVuJyk7XHJcbiAgICB9KTtcclxufTtcclxuXHJcbmZldGNoKGxpbmtUb015R2l0KVxyXG4gICAgLnRoZW4ocmVzcG9uc2UgPT4ge1xyXG4gICAgICAgIGlmIChyZXNwb25zZS5zdGF0dXMgPT09IDIwMCkge1xyXG4gICAgICAgICAgICByZXR1cm4gcmVzcG9uc2UuanNvbigpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGFsZXJ0KCfQl9Cw0L/RgNC+0YEg0L3QsCBnaXRodWIuY29tINC90LUg0YPQtNCw0LvRgdGPLiDQntGI0LjQsdC60LA6ICcgKyByZXNwb25zZS5zdGF0dXMpO1xyXG4gICAgICAgIH1cclxuICAgIH0pXHJcbiAgICAudGhlbihqc29uID0+IHtcclxuICAgICAgICBudW1SZXBvcyA9IGpzb24ucHVibGljX3JlcG9zO1xyXG4gICAgICAgIHJldHVybiBudW1SZXBvczsgICAgICAgICAgIFxyXG4gICAgfSlcclxuICAgIC50aGVuKG51bVJlcG9zID0+IHtcclxuICAgICAgICBsZXQgbnVtUGFnZXMgPSBNYXRoLmNlaWwobnVtUmVwb3MvcmVwb3NQZXJQYWdlKTtcclxuICAgICAgICBmb3IobGV0IGkgPSAxOyBpIDw9IG51bVBhZ2VzOyBpKyspIHtcclxuICAgICAgICAgICAgY3JlYXRlUGFnaW5hdGlvbihpKTtcclxuICAgICAgICB9O1xyXG4gICAgfSk7XHJcblxyXG5mdW5jdGlvbiBnaXRJdGVtQ3JlYXRvcihlbGVtZW50KSB7XHJcbiAgICBjb25zdCBjb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuZ2l0X19saXN0Jyk7XHJcblxyXG4gICAgY29uc3QgaXRlbSA9IGNyZWF0ZUVsZW1lbnQoJ2xpJyk7XHJcbiAgICBpdGVtLmNsYXNzTGlzdC5hZGQoJ2dpdF9fbWFpbl9faXRlbScpO1xyXG5cclxuICAgIGNvbnN0IGxpbmsgPSBjcmVhdGVFbGVtZW50KCdhJyk7XHJcbiAgICBsaW5rLmNsYXNzTGlzdC5hZGQoJ2dpdF9faXRlbS1pbm5lcldyYXAnKTtcclxuICAgIGxpbmsuY2xhc3NMaXN0LmFkZCgnbGluaycpO1xyXG4gICAgbGluay5ocmVmID0gZWxlbWVudC5odG1sX3VybDtcclxuICAgIGxpbmsudGFyZ2V0ID0gJ2JsYW5rJztcclxuXHJcbiAgICBjb25zdCB0aXRsZSA9IGNyZWF0ZUVsZW1lbnQoJ3AnKTtcclxuICAgIHRpdGxlLmNsYXNzTGlzdC5hZGQoJ2dpdF9faXRlbS10aXRsZScpO1xyXG4gICAgdGl0bGUuaW5uZXJIVE1MID0gZWxlbWVudC5uYW1lO1xyXG5cclxuICAgIGNvbnN0IHN0cmluZyA9IGNyZWF0ZUVsZW1lbnQoJ3AnKTtcclxuICAgIHN0cmluZy5jbGFzc0xpc3QuYWRkKCdnaXRfX2l0ZW0tdGV4dCcpO1xyXG5cclxuICAgIGNvbnN0IG1hcmtlciA9IGNyZWF0ZUVsZW1lbnQoJ3NwYW4nKTtcclxuICAgIG1hcmtlci5jbGFzc0xpc3QuYWRkKCdtYXJrZXInKTtcclxuICAgIHN3aXRjaChlbGVtZW50Lmxhbmd1YWdlKSB7XHJcbiAgICAgICAgY2FzZSAnSFRNTCc6XHJcbiAgICAgICAgICAgIG1hcmtlci5jbGFzc0xpc3QuYWRkKCdtYXJrZXJfSFRNTCcpO1xyXG4gICAgICAgICAgICBicmVhaztcclxuICAgICAgICBjYXNlICdDU1MnOlxyXG4gICAgICAgICAgICBtYXJrZXIuY2xhc3NMaXN0LmFkZCgnbWFya2VyX0NTUycpO1xyXG4gICAgICAgICAgICBicmVhaztcclxuICAgICAgICBjYXNlICdKUyc6XHJcbiAgICAgICAgICAgIG1hcmtlci5jbGFzc0xpc3QuYWRkKCdtYXJrZXJfSlMnKTtcclxuICAgICAgICAgICAgYnJlYWs7XHJcbiAgICB9O1xyXG5cclxuICAgIGNvbnN0IHByb2dMYW5nID0gY3JlYXRlRWxlbWVudCgnc3BhbicpO1xyXG4gICAgcHJvZ0xhbmcuY2xhc3NMaXN0LmFkZCgndGV4dC1lbGVtZW50Jyk7XHJcbiAgICBwcm9nTGFuZy5jbGFzc0xpc3QuYWRkKCd0ZXh0LWVsZW1lbnRfcHJvZ0xhbmcnKTtcclxuICAgIHByb2dMYW5nLmlubmVySFRNTCA9IGVsZW1lbnQubGFuZ3VhZ2U7XHJcblxyXG4gICAgY29uc3Qgc3RhcldyYXAgPSBjcmVhdGVFbGVtZW50KCdzcGFuJyk7XHJcbiAgICBzdGFyV3JhcC5jbGFzc0xpc3QuYWRkKCd0ZXh0LWVsZW1lbnQnKTtcclxuXHJcbiAgICBjb25zdCBzdGFyID0gY3JlYXRlRWxlbWVudCgnc3BhbicpO1xyXG4gICAgc3Rhci5jbGFzc0xpc3QuYWRkKCd0ZXh0LWVsZW1lbnRfc3RhcicpO1xyXG5cclxuICAgIGNvbnN0IGZvcmtXcmFwID0gY3JlYXRlRWxlbWVudCgnc3BhbicpO1xyXG4gICAgZm9ya1dyYXAuY2xhc3NMaXN0LmFkZCgndGV4dC1lbGVtZW50Jyk7XHJcblxyXG4gICAgY29uc3QgZm9yayA9IGNyZWF0ZUVsZW1lbnQoJ3NwYW4nKTtcclxuICAgIGZvcmsuY2xhc3NMaXN0LmFkZCgndGV4dC1lbGVtZW50X2ZvcmsnKTtcclxuXHJcbiAgICBjb25zdCBkYXRlVXBkYXRlID0gY3JlYXRlRWxlbWVudCgnc3BhbicpO1xyXG4gICAgZGF0ZVVwZGF0ZS5jbGFzc0xpc3QuYWRkKCd0ZXh0LWVsZW1lbnQnKTtcclxuICAgIGRhdGVVcGRhdGUuY2xhc3NMaXN0LmFkZCgndGV4dC1lbGVtZW50X3VwZGF0ZScpO1xyXG4gICAgZGF0ZVVwZGF0ZS5pbm5lckhUTUwgPSAn0J7QsdC90L7QstC70LXQvdC+ICcgKyBuZXcgRGF0ZShlbGVtZW50LnVwZGF0ZWRfYXQpLnRvTG9jYWxlRGF0ZVN0cmluZygncnUnKSArICfQsy4nO1xyXG5cclxuICAgIHN0YXJXcmFwLmFwcGVuZENoaWxkKHN0YXIpO1xyXG4gICAgZm9ya1dyYXAuYXBwZW5kQ2hpbGQoZm9yayk7XHJcblxyXG4gICAgc3RyaW5nLmFwcGVuZENoaWxkKG1hcmtlcik7XHJcbiAgICBzdHJpbmcuYXBwZW5kQ2hpbGQocHJvZ0xhbmcpO1xyXG4gICAgc3RyaW5nLmFwcGVuZENoaWxkKHN0YXJXcmFwKTtcclxuICAgIHN0cmluZy5hcHBlbmRDaGlsZChmb3JrV3JhcCk7XHJcbiAgICBzdHJpbmcuYXBwZW5kQ2hpbGQoZGF0ZVVwZGF0ZSk7XHJcblxyXG4gICAgbGluay5hcHBlbmRDaGlsZCh0aXRsZSk7XHJcbiAgICBsaW5rLmFwcGVuZENoaWxkKHN0cmluZyk7XHJcblxyXG4gICAgaXRlbS5hcHBlbmRDaGlsZChsaW5rKTtcclxuXHJcbiAgICBpZihlbGVtZW50LnN0YXJnYXplcnNfY291bnQpIHtcclxuICAgICAgICBzdGFyV3JhcC5hcHBlbmRDaGlsZCggZG9jdW1lbnQuY3JlYXRlVGV4dE5vZGUoZWxlbWVudC5zdGFyZ2F6ZXJzX2NvdW50KSApO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgICBzdGFyV3JhcC5yZW1vdmUoKTtcclxuICAgIH07XHJcblxyXG4gICAgaWYoZWxlbWVudC5mb3Jrc19jb3VudCkge1xyXG4gICAgICAgIGZvcmsuYXBwZW5kQ2hpbGQoIGRvY3VtZW50LmNyZWF0ZVRleHROb2RlKGVsZW1lbnQuZm9ya3NfY291bnQpICk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAgIGZvcmsucmVtb3ZlKCk7XHJcbiAgICB9O1xyXG5cclxuICAgIGNvbnRhaW5lci5hcHBlbmRDaGlsZChpdGVtKTtcclxufTtcclxuXHJcbmZ1bmN0aW9uIGNyZWF0ZVBhZ2luYXRpb24ocGFnZUNvdW50KSB7XHJcbiAgICBsZXQgcGFnaW5hdG9yID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnBhZ2luYXRvcicpO1xyXG4gICAgbGV0IHBhZ2luYXRpb25JdGVtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnBhZ2luYXRvcl9faXRlbScpLmNsb25lTm9kZSh0cnVlKTtcclxuICAgIHBhZ2luYXRpb25JdGVtLmNsYXNzTGlzdC5yZW1vdmUoJ2hpZGRlbicpO1xyXG4gICAgaWYocGFnZUNvdW50ID09PSAxKSB7XHJcbiAgICAgICAgcGFnaW5hdGlvbkl0ZW0uY2xhc3NMaXN0LmFkZCgncGFnaW5hdG9yX19pdGVtX2FjdGl2ZScpO1xyXG4gICAgfTtcclxuICAgIHBhZ2luYXRpb25JdGVtLmFwcGVuZENoaWxkKCBkb2N1bWVudC5jcmVhdGVUZXh0Tm9kZShwYWdlQ291bnQpICk7XHJcbiAgICBwYWdpbmF0b3IuYXBwZW5kQ2hpbGQoIHBhZ2luYXRpb25JdGVtICk7XHJcbn07XHJcblxyXG5mdW5jdGlvbiBnb1BhZ2luYXRpb24oKSB7XHJcbiAgICBsZXQgcGFnaW5hdG9yID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnBhZ2luYXRvcicpO1xyXG4gICAgcGFnaW5hdG9yLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGUpID0+IHtcclxuICAgICAgICBpZihlLnRhcmdldC5jbGFzc05hbWUgPT09ICdwYWdpbmF0b3JfX2l0ZW0nKSB7XHJcblxyXG4gICAgICAgICAgICBsZXQgYWxsUmVwb3MgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuZ2l0X19tYWluX19pdGVtJyk7XHJcbiAgICAgICAgICAgIGFsbFJlcG9zID0gQXJyYXkuZnJvbShhbGxSZXBvcyk7XHJcbiAgICAgICAgICAgIGFsbFJlcG9zLmZvckVhY2goZWxlbWVudCA9PiB7XHJcbiAgICAgICAgICAgICAgICBlbGVtZW50LnJlbW92ZSgpO1xyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIGxldCBwYWdlID0gZS50YXJnZXQuaW5uZXJUZXh0O1xyXG4gICAgICAgICAgICBnZXRSZXBvcyhwYWdlKTtcclxuXHJcbiAgICAgICAgICAgIGxldCBwYWdpbmF0aW9uSXRlbXMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcucGFnaW5hdG9yX19pdGVtJyk7XHJcbiAgICAgICAgICAgIHBhZ2luYXRpb25JdGVtcyA9IEFycmF5LmZyb20ocGFnaW5hdGlvbkl0ZW1zKTtcclxuICAgICAgICAgICAgcGFnaW5hdGlvbkl0ZW1zLmZvckVhY2goZWxlbWVudCA9PiB7XHJcbiAgICAgICAgICAgICAgICBlbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoJ3BhZ2luYXRvcl9faXRlbV9hY3RpdmUnKTsgICAgICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIGUudGFyZ2V0LmNsYXNzTGlzdC5hZGQoJ3BhZ2luYXRvcl9faXRlbV9hY3RpdmUnKTtcclxuICAgICAgICB9O1xyXG4gICAgfSk7XHJcbn07XHJcblxyXG5mdW5jdGlvbiBjcmVhdGVFbGVtZW50KHRhZykge1xyXG4gICAgY29uc3QgZWxlbWVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQodGFnKTtcclxuICAgIHJldHVybiBlbGVtZW50O1xyXG59OyIsImxldCBidXJnZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuYnVyZ2VyJyk7XHJcbmxldCBidXJnZXJJdGVtMSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5idXJnZXJfX2l0ZW0tMScpO1xyXG5sZXQgYnVyZ2VySXRlbTIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuYnVyZ2VyX19pdGVtLTInKTtcclxubGV0IG1vYmlsZU1lbnUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuaGVhZGVyX19tb2JpbGVNZW51Jyk7XHJcbmxldCBtYWluID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignbWFpbicpO1xyXG5sZXQgZm9vdGVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmZvb3Rlcl9fd3JhcCcpO1xyXG5idXJnZXIuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XHJcbiAgICBidXJnZXJJdGVtMS5jbGFzc0xpc3QudG9nZ2xlKCdidXJnZXJfX2l0ZW0tMV9hY3RpdmUnKTtcclxuICAgIGJ1cmdlckl0ZW0yLmNsYXNzTGlzdC50b2dnbGUoJ2J1cmdlcl9faXRlbS0yX2FjdGl2ZScpO1xyXG4gICAgbW9iaWxlTWVudS5jbGFzc0xpc3QudG9nZ2xlKCdoaWRkZW4nKTtcclxuICAgIG1haW4uY2xhc3NMaXN0LnRvZ2dsZSgnaGlkZGVuJyk7XHJcbiAgICBmb290ZXIuY2xhc3NMaXN0LnRvZ2dsZSgnaGlkZGVuJyk7XHJcbn0pO1xyXG5cclxubGV0IGJvZHkgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdib2R5Jyk7XHJcbmJvZHkuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZSkgPT4ge1xyXG4gICAgaWYoIGUudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucygnc2Nyb2xsJykgKSB7XHJcblxyXG4gICAgICAgIGJ1cmdlckl0ZW0xLmNsYXNzTGlzdC5yZW1vdmUoJ2J1cmdlcl9faXRlbS0xX2FjdGl2ZScpO1xyXG4gICAgICAgIGJ1cmdlckl0ZW0yLmNsYXNzTGlzdC5yZW1vdmUoJ2J1cmdlcl9faXRlbS0yX2FjdGl2ZScpO1xyXG4gICAgICAgIG1vYmlsZU1lbnUuY2xhc3NMaXN0LmFkZCgnaGlkZGVuJyk7XHJcbiAgICAgICAgbWFpbi5jbGFzc0xpc3QucmVtb3ZlKCdoaWRkZW4nKTtcclxuICAgICAgICBmb290ZXIuY2xhc3NMaXN0LnJlbW92ZSgnaGlkZGVuJyk7XHJcblxyXG4gICAgICAgIGxldCB0YXJnZXRDbGFzcyA9IGUudGFyZ2V0LmRhdGFzZXQudGFyZ2V0O1xyXG4gICAgICAgIGxldCBhaW1CbG9jayA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy4nICsgdGFyZ2V0Q2xhc3MpO1xyXG4gICAgICAgIGxldCBmaW5pc2ggPSBhaW1CbG9jay5vZmZzZXRUb3A7XHJcbiAgICAgICAgbGV0IHN0YXJ0ID0gd2luZG93LnBhZ2VZT2Zmc2V0O1xyXG4gICAgICAgIGxldCBudW1TdGVwID0gNTA7XHJcbiAgICAgICAgbGV0IGxlbmdodFN0ZXAgPSAoZmluaXNoLXN0YXJ0KS9udW1TdGVwO1xyXG4gICAgICAgIGxldCBwcm9ncmVzcyA9IHN0YXJ0O1xyXG4gICAgICAgIGxldCBjb3VudFN0ZXAgPSAwO1xyXG5cclxuICAgICAgICBzY3JvbGwoKTtcclxuXHJcbiAgICAgICAgZnVuY3Rpb24gc2Nyb2xsKCkge1xyXG4gICAgICAgICAgICBwcm9ncmVzcyArPSBsZW5naHRTdGVwO1xyXG4gICAgICAgICAgICBzZXRUaW1lb3V0KCAoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICB3aW5kb3cuc2Nyb2xsVG8oMCwgcHJvZ3Jlc3MpO1xyXG4gICAgICAgICAgICAgICAgY291bnRTdGVwKys7XHJcbiAgICAgICAgICAgICAgICBpZihjb3VudFN0ZXAgPCBudW1TdGVwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgc2Nyb2xsKCk7XHJcbiAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICB9LCAxMCk7XHJcbiAgICAgICAgfTtcclxuICAgIH07XHJcbn0pOyIsIndpbmRvdy5vbmxvYWQgPSAoKSA9PiB7XHJcbiAgICBsZXQgcHJlbG9hZGVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnByZWxvYWRlcl9fd3JhcF9nbG9iYWwnKTtcclxuICAgIHByZWxvYWRlci5jbGFzc0xpc3QuYWRkKCdoaWRkZW4nKTtcclxuICB9OyIsImxldCB2aWV3QWxsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLnJlY2VudFdvcmtzX190aXRsZS1zaWRlJyk7XHJcbmxldCBoaWRkZW5Xb3JrcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5yZWNlbnRXb3Jrc19fZXhhbXBsZScpLnF1ZXJ5U2VsZWN0b3JBbGwoJy5oaWRkZW4nKTtcclxuXHJcbnZpZXdBbGwgPSBBcnJheS5mcm9tKHZpZXdBbGwpO1xyXG52aWV3QWxsLmZvckVhY2goYnV0dG9uID0+IHtcclxuICAgIGJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcclxuICAgICAgICBoaWRkZW5Xb3Jrcy5mb3JFYWNoKGVsZW1lbnQgPT4ge1xyXG4gICAgICAgICAgICBlbGVtZW50LmNsYXNzTGlzdC50b2dnbGUoJ2hpZGRlbicpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHZpZXdBbGwuZm9yRWFjaChidXR0b24gPT4ge1xyXG4gICAgICAgICAgICBidXR0b24uY2xhc3NMaXN0LnRvZ2dsZSgnaGlkZGVuJyk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9KTtcclxufSk7Il19
